<div class="demo-container">
    <div class="header">
        <h2>üìä High-Performance Table</h2>
        <p>Handling 1,000+ rows with Signals, Sorting, Filtering, and Pagination.</p>
    </div>

    <div class="table-card glass-panel">
        <!-- Controls -->
        <div class="table-controls">
            <div class="search-box">
                <span class="search-icon">üîç</span>
                <input type="text" placeholder="Search products..." [ngModel]="filterQuery()"
                    (ngModelChange)="filterQuery.set($event)" class="search-input">
            </div>
            <div class="meta-info">
                Showing {{ paginatedProducts().length }} of {{ filteredProducts().length }} items
            </div>
        </div>

        <!-- Table -->
        <div class="table-wrapper">
            <table>
                <thead>
                    <tr>
                        <th (click)="sort('id')" [class.active]="sortConfig().column === 'id'">
                            ID <span class="sort-icon">{{ sortConfig().column === 'id' ? (sortConfig().direction ===
                                'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th (click)="sort('name')" [class.active]="sortConfig().column === 'name'">
                            Product Name <span class="sort-icon">{{ sortConfig().column === 'name' ?
                                (sortConfig().direction === 'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th (click)="sort('category')" [class.active]="sortConfig().column === 'category'">
                            Category <span class="sort-icon">{{ sortConfig().column === 'category' ?
                                (sortConfig().direction === 'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th (click)="sort('price')" [class.active]="sortConfig().column === 'price'">
                            Price <span class="sort-icon">{{ sortConfig().column === 'price' ? (sortConfig().direction
                                === 'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th (click)="sort('stock')" [class.active]="sortConfig().column === 'stock'">
                            Stock <span class="sort-icon">{{ sortConfig().column === 'stock' ? (sortConfig().direction
                                === 'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th (click)="sort('status')" [class.active]="sortConfig().column === 'status'">
                            Status <span class="sort-icon">{{ sortConfig().column === 'status' ? (sortConfig().direction
                                === 'asc' ? '‚Üë' : '‚Üì') : '' }}</span>
                        </th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    @for (product of paginatedProducts(); track product.id) {
                    <tr class="table-row" [class.editing]="editingRowId() === product.id">
                        <td>#{{ product.id }}</td>

                        <!-- Name -->
                        <td>
                            @if (editingRowId() === product.id && editForm()) {
                            <input type="text" [ngModel]="editForm()!.name"
                                (ngModelChange)="updateEditForm('name', $event)" class="edit-input">
                            } @else {
                            <span class="font-bold">{{ product.name }}</span>
                            }
                        </td>

                        <!-- Category -->
                        <td>
                            @if (editingRowId() === product.id && editForm()) {
                            <select [ngModel]="editForm()!.category"
                                (ngModelChange)="updateEditForm('category', $event)" class="edit-input">
                                <option value="Electronics">Electronics</option>
                                <option value="Clothing">Clothing</option>
                                <option value="Home">Home</option>
                                <option value="Sports">Sports</option>
                                <option value="Books">Books</option>
                            </select>
                            } @else {
                            <span class="badge">{{ product.category }}</span>
                            }
                        </td>

                        <!-- Price -->
                        <td>
                            @if (editingRowId() === product.id && editForm()) {
                            <input type="number" [ngModel]="editForm()!.price"
                                (ngModelChange)="updateEditForm('price', $event)" class="edit-input small">
                            } @else {
                            <span class="price">${{ product.price }}</span>
                            }
                        </td>

                        <!-- Stock -->
                        <td>
                            @if (editingRowId() === product.id && editForm()) {
                            <input type="number" [ngModel]="editForm()!.stock"
                                (ngModelChange)="updateEditForm('stock', $event)" class="edit-input small">
                            } @else {
                            {{ product.stock }} units
                            }
                        </td>

                        <!-- Status -->
                        <td>
                            @if (editingRowId() === product.id && editForm()) {
                            <select [ngModel]="editForm()!.status" (ngModelChange)="updateEditForm('status', $event)"
                                class="edit-input">
                                <option value="In Stock">In Stock</option>
                                <option value="Low Stock">Low Stock</option>
                                <option value="Out of Stock">Out of Stock</option>
                            </select>
                            } @else {
                            <span class="status-badge" [ngClass]="getStatusClass(product.status)">
                                {{ product.status }}
                            </span>
                            }
                        </td>

                        <!-- Actions -->
                        <td>
                            @if (editingRowId() === product.id) {
                            <div class="action-buttons">
                                <button (click)="saveEdit()" class="btn-icon save" title="Save">üíæ</button>
                                <button (click)="cancelEdit()" class="btn-icon cancel" title="Cancel">‚ùå</button>
                            </div>
                            } @else {
                            <button (click)="startEdit(product)" class="btn-icon edit" title="Edit">‚úèÔ∏è</button>
                            }
                        </td>
                    </tr>
                    } @empty {
                    <tr>
                        <td colspan="7" class="empty-state">No products found matching "{{ filterQuery() }}"</td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination">
            <button (click)="prevPage()" [disabled]="currentPage() === 1" class="btn-page">Previous</button>
            <span class="page-info">Page {{ currentPage() }} of {{ totalPages() }}</span>
            <button (click)="nextPage()" [disabled]="currentPage() === totalPages()" class="btn-page">Next</button>
        </div>
    </div>
</div>